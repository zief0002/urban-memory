---
title: "Assignment 02"
author: "Matrix Decomposition"
date: "Answer Key"
header-includes:
   - \usepackage{xcolor}
   - \definecolor{umn}{HTML}{FF2D21}
   - \usepackage{caption}
   - \captionsetup[table]{textfont={it}, labelfont={bf}, singlelinecheck=false, labelsep=newline}
   - \captionsetup[figure]{textfont={it}, labelfont={bf}, singlelinecheck=false, labelsep=newline}
   - \usepackage{floatrow}
   - \floatsetup[figure]{capposition=top}
   - \usepackage{xfrac}
output: 
  pdf_document:
    highlight: tango
    latex_engine: xelatex
    fig_width: 6
    fig_height: 6
mainfont: "Sabon"
sansfont: "Helvetica Neue UltraLight"
monofont: "Inconsolata"
urlcolor: "umn"
always_allow_html: yes
---

This assignment is worth 15 points. Use the matrix **A** throughout this assignment:

$$
\mathbf{A} = \begin{bmatrix}2 & 6\\-1 & 7\end{bmatrix}
$$


<!-- ```{r echo=FALSE, message=FALSE} -->
<!-- # Load libraries -->
<!-- library(broom) -->
<!-- library(knitr) -->
<!-- library(kableExtra) -->
<!-- library(tidyverse) -->
<!-- ``` -->



# Eigendecomposition 

Questions 1-5 in this section should be solved by hand. 

**1. Find the eigenvalues of A.**

$$
\begin{split}
\mathrm{det}\big(\mathbf{A} - \lambda \mathbf{I}\big) &= 0 \\[0.5em]
\mathrm{det}\bigg(\begin{bmatrix}2 & 6\\-1 & 7\end{bmatrix} - \lambda\begin{bmatrix}
1 & 0  \\ 
0 & 1  \\
\end{bmatrix}\bigg) &= 0 \\[0.5em]
\mathrm{det}\bigg(\begin{bmatrix}2-\lambda & 6\\-1 & 7-\lambda\end{bmatrix}\bigg) &= 0 \\[0.5em]
(2-\lambda)(7-\lambda) - (-6) &= 0 \\[0.5em]
\lambda^2 - 9\lambda + 20 &=0 \\[0.5em]
(\lambda - 5)(\lambda - 4) &= 0 \\[0.5em]
\lambda = 4 \quad\mathrm{and}\quad\lambda = &5
\end{split}
$$

\vspace{2em}


**2. Write the two specific characteristic equations.**

$$
\begin{split}
\mathrm{det}\big(\mathbf{A} - 4 \mathbf{I}\big) &= 0 \\[0.5em]
\mathrm{det}\big(\mathbf{A} - 5 \mathbf{I}\big) &= 0
\end{split}
$$

\newpage


**3. Find the eigenvectors for A.**

$$
\begin{split}
\mathbf{A}\mathbf{v} &= \lambda \mathbf{v} \\[0.5em]
\begin{bmatrix}2 & 6\\-1 & 7\end{bmatrix}\begin{bmatrix}v_1\\v_2\end{bmatrix} &= 4\begin{bmatrix}v_1\\v_2\end{bmatrix} \\[0.5em]
\begin{bmatrix}2v_1 + 6v_2\\-1v_1 + 7v_2\end{bmatrix} &= \begin{bmatrix}4v_1\\4v_2\end{bmatrix} \\[0.5em]
-v_1 + 3v_2 &= 0 \\[0.5em]
v_1 &= 3\theta \\
v_2 &= \theta \\[0.5em]
9\theta^2 + \theta^2 &= 1\\
\theta^2 &= \frac{1}{10}\\[0.5em]
\theta &= \frac{1}{\sqrt{10}}\\[0.5em]
\mathbf{v} &= \begin{bmatrix}\frac{3}{\sqrt{10}}\\\frac{1}{\sqrt{10}}\end{bmatrix}
\end{split}
$$

\vspace{1.5em}

$$
\begin{split}
\mathbf{A}\mathbf{v} &= \lambda \mathbf{v} \\[0.5em]
\begin{bmatrix}2 & 6\\-1 & 7\end{bmatrix}\begin{bmatrix}v_1\\v_2\end{bmatrix} &= 5\begin{bmatrix}v_1\\v_2\end{bmatrix} \\[0.5em]
\begin{bmatrix}2v_1 + 6v_2\\-1v_1 + 7v_2\end{bmatrix} &= \begin{bmatrix}5v_1\\5v_2\end{bmatrix} \\[0.5em]
-v_1 + 2v_2 &= 0 \\[0.5em]
v_1 &= 2\theta \\
v_2 &= \theta \\[0.5em]
4\theta^2 + \theta^2 &= 1\\
\theta^2 &= \frac{1}{5}\\[0.5em]
\theta &= \frac{1}{\sqrt{5}}\\[0.5em]
\mathbf{v} &= \begin{bmatrix}\frac{2}{\sqrt{5}}\\\frac{1}{\sqrt{5}}\end{bmatrix}
\end{split}
$$

\newpage

**Compute and verify the following:**

**4. $\mathrm{tr}(\mathbf{A}) = \sum_{i=1}^n \lambda_i$**

$$
\begin{split}
\mathrm{tr}(\mathbf{A}) &= 2 + 7 = 9 \\[0.5em]
\sum_{i=1}^n \lambda_i &= 4 + 5 = 9
\end{split}
$$

\vspace{2em}

**5. $\mathrm{det}(\mathbf{A}) = \prod_{i=1}^n \lambda_i$ **

$$
\begin{split}
\mathrm{det}(\mathbf{A}) &= 2(7) - (-1)(6) = 20 \\[0.5em]
\prod_{i=1}^n \lambda_i &= 4(5) = 20
\end{split}
$$

\vspace{2em}

**Use R for Questions 6--8. Show the syntax you used.**

**6. Verify that P is invertible.**

```{r}
# Create P
P = matrix(c(2/sqrt(5), 1/sqrt(5), 3/sqrt(10), 1/sqrt(10)), nrow = 2)

# Check that P has an inverse
solve(P)

# Or check if determinant is 0
det(P) == 0
```

\newpage

**7. Compute D using the eigenvectors you computed in Question 3.**

```{r}
# Create A
A = matrix(c(2, -1, 6, 7), nrow = 2)

# Compute D
solve(P) %*% A %*% P
```
$$
D = \begin{bmatrix}5 & 0\\0 & 4\end{bmatrix}
$$

\vspace{2em}

**8. Verify that $\mathbf{A}=\mathbf{P}\mathbf{D}\mathbf{P}^{-1}$ **

```{r}
# Create D
D = matrix(c(5, 0, 0, 4), nrow = 2)

# Compute A
P %*% D %*% solve(P)
```

\vspace{2em}

**9. Use the equation for A given in Question 8 and the properties of matrix inverses to express $\mathbf{A}^{-1}$ as a function of D and P.**

$$
\begin{split}
\mathbf{A}^{-1} &= (\mathbf{P}\mathbf{D}\mathbf{P}^{-1})^{-1} \\[0.5em]
&= \mathbf{P}(\mathbf{P}\mathbf{D})^{-1} \\[0.5em]
&= \mathbf{P}\mathbf{D}^{-1}\mathbf{P}^{-1}
\end{split}
$$

\newpage

**10. Verify the equation you produced in Question 9 using R. Show your syntax.**

```{r}
# Inverse of A
solve(A)

# Verify equation
P %*% solve(D) %*% solve(P)
```

\vspace{2em}

# LU Decomposition

**11. Explain why we can we carry out LU (or LUP) decomposition on A by referring to the properties of A.**  

Since **A** is a square matrix we can carry out LU/LUP decomposition.

\vspace{2em}


**12. Write out the system of equations, assuming L is a unit triangular matrix, that allow you to solve for the elements of L and U.**

$$
\begin{bmatrix}2 & 6\\-1 & 7\end{bmatrix} = \begin{bmatrix}
1 & 0 \\ 
l_{21}& 1 \\
\end{bmatrix}\begin{bmatrix}
u_{11} & u_{12}  \\ 
0 & u_{22} \\
\end{bmatrix}
$$

\vspace{2em}

**13. Give the L and U matrices.**

$$
\begin{split}
2 &= 1(u_{11}) + 0(0) \\ 
6 &= 1(u_{12}) + 0(u_{22})\\
-1 &= l_{21}(u_{11}) + 1(0)\\
7 &= l_{21}(u_{12}) + 1(u_{22})\\[1em]
l_{21} &= -0.5\\
u_{11} &= 2 \\
u_{12} &= 6 \\
u_{22} &= 10 \\[1em]
\mathbf{L} &= \begin{bmatrix}
1 & 0 \\ 
-0.5 & 1 \\
\end{bmatrix} \\
\mathbf{U} & = \begin{bmatrix}
2 & 6  \\ 
0 & 10 \\
\end{bmatrix}
\end{split}
$$

\vspace{2em}

**14. Verify that the matrices given in Question 13 produce A using R. Show your syntax.**

```{r}
# Create L
L = matrix(c(1, -0.5, 0, 1), nrow = 2)

# Create U
U = matrix(c(2, 0, 6, 10), nrow = 2)

# Verify
L %*% U
```


\vspace{2em}

**15. Use the LU decomposition to solve the following system of equations. Solve this by hand.**

$$
\begin{split}
2x_1 + 6x_2 &= 24\\[0.5em]
-x_1 + 7x_2 &= -38
\end{split}
$$

Step 1

$$
\begin{split}
\mathbf{L}\mathbf{Z} &= \mathbf{Y} \\[0.5em]
\begin{bmatrix}
1 & 0 \\ 
-0.5 & 1 \\
\end{bmatrix}\begin{bmatrix}
z_1  \\ 
z_2 \\
\end{bmatrix} &= \begin{bmatrix}
24 \\ 
38 \\
\end{bmatrix} \\[0.5em]
z_1 &=24 \\[0.5em]
z_2 &=50
\end{split}
$$

Step 2

$$
\begin{split}
\mathbf{U}\mathbf{X} &= \mathbf{Z} \\[0.5em]
\begin{bmatrix}
2 & 6  \\ 
0 & 10 \\
\end{bmatrix}\begin{bmatrix}
x_1  \\ 
x_2 \\
\end{bmatrix} &= \begin{bmatrix}
24 \\ 
50 \\
\end{bmatrix} \\[0.5em]
x_1 &=-3 \\[0.5em]
x_2 &=5
\end{split}
$$

