<!DOCTYPE html>
<html>
  <head>
    <title>Matrix Computations in R</title>
    <meta charset="utf-8">
    <meta name="author" content="Andrew Zieffler“" />
    <meta name="date" content="2018-09-27" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis.css" rel="stylesheet" />
    <link href="libs/remark-css/metropolis-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Matrix Computations in R
## EPsy 8264
### Andrew Zieffler“
### 2018-09-27

---





# Enter a Matrix

.pull-left[
`$$\mathbf{X} = \begin{bmatrix}
1 &amp; -2 &amp; 3 \\ 
4 &amp; -5 &amp; -6 \\ 
7 &amp; 8 &amp; 9 \\ 
0 &amp; 0 &amp; 10
\end{bmatrix}$$`

To enter a matrix in R, use the `matrix()` function. The elements of the matrix will be filled-in by columns.
]

.pull-right[


```r
X = matrix(
  data = c(1,  4, 7,  0, 
          -2, -5, 8,  0, 
           3, -6, 9, 10),
  nrow = 4,
  ncol = 3
  )

X
```

```
##      [,1] [,2] [,3]
## [1,]    1   -2    3
## [2,]    4   -5   -6
## [3,]    7    8    9
## [4,]    0    0   10
```
]

---

# Fill Elements By Row

.pull-left[
The `byrow=TRUE` argument will fill the elements by rows rather than columns.
]

.pull-right[

```r
# Enter elements by row
X = matrix(
  data = c(1, -2,  3,
           4, -5, -6,
           7,  8,  9,
           0,  0, 10),
* byrow = TRUE,
  nrow = 4
  )

X
```

```
##      [,1] [,2] [,3]
## [1,]    1   -2    3
## [2,]    4   -5   -6
## [3,]    7    8    9
## [4,]    0    0   10
```
]

---

# Your Turn

Enter the matrix **B** into R.

`$$\mathbf{B} = \begin{bmatrix}
-5 &amp; 1 &amp; 3 \\ 
2 &amp; 2 &amp; 6 \\ 
7 &amp; 3 &amp; -4
\end{bmatrix}$$`

--


```r
B = matrix(
  data = c(-5, 1,  3,
            2, 2,  6,
            7, 3, -4),
  byrow = TRUE,
  nrow = 3
  )
```


---

# Vectors

.pull-left[
A matrix with a single column is referred to as a **column vector**. 

`$$\mathbf{a} = \begin{bmatrix}
2 \\ 
0 \\ 
1 \\
3
\end{bmatrix}$$`

]

.pull-right[

```r
# Enter column vector
a = matrix(
  data = c(2, 0, 1, 3),
  byrow = TRUE,
  nrow = 4
  )

a
```

```
##      [,1]
## [1,]    2
## [2,]    0
## [3,]    1
## [4,]    3
```
]

---

.pull-left[
A matrix with a single row is referred to as a **row vector**. 

`$$\mathbf{b} = \begin{bmatrix}
-1 &amp; 6 &amp; 0 &amp; 9 \end{bmatrix}$$`

]

.pull-right[

```r
# Enter row vector
b = matrix(
  data = c(-1, 6, 0, 9),
  byrow = TRUE,
  nrow = 1
  )

b
```

```
##      [,1] [,2] [,3] [,4]
## [1,]   -1    6    0    9
```
]


---

# Dimensions of a Matrix

.pull-left[
`$$\underset{4\times 3}{\mathbf{X}} = \begin{bmatrix}
1 &amp; -2 &amp; 3 \\ 
4 &amp; -5 &amp; -6 \\ 
7 &amp; 8 &amp; 9 \\ 
0 &amp; 0 &amp; 10
\end{bmatrix}$$`

`$$\underset{4\times 1}{\mathbf{a}} = \begin{bmatrix}
2 \\ 
0 \\ 
1 \\
3
\end{bmatrix}$$`
`$$\underset{1\times 4}{\mathbf{b}} = \begin{bmatrix}
-1 &amp; 6 &amp; 0 &amp; 9 \end{bmatrix}$$`
]

.pull-right[
The `dim()` function will return the dimensions of a matrix.


```r
# Dimensions of X
dim(X)
```

```
## [1] 4 3
```

```r
# Dimensions of column vector a
dim(a)
```

```
## [1] 4 1
```

```r
# Dimensions of row vector b
dim(b)
```

```
## [1] 1 4
```
]
---

# Your Turn

What are the dimensions of **B**?

`$$\mathbf{B} = \begin{bmatrix}
-5 &amp; 1 &amp; 3 \\ 
2 &amp; 2 &amp; 6 \\ 
7 &amp; 3 &amp; -4
\end{bmatrix}$$`

Use R to verify the dimensions.

--


```r
dim(B)
```

```
## [1] 3 3
```

---

# Transpose

.pull-left[
The `t()` function will produce the transpose of a matrix.

`$$\begin{split}\mathbf{b} &amp;= \begin{bmatrix}
-1 &amp; 6 &amp; 0 &amp; 9 \end{bmatrix}\\[1em]
\mathbf{b^{\prime}} &amp;= \begin{bmatrix}
-1 \\ 6 \\ 0 \\ 9 \end{bmatrix}\end{split}$$`
]

.pull-right[

```r
# Matrix transpose
t(b)
```

```
##      [,1]
## [1,]   -1
## [2,]    6
## [3,]    0
## [4,]    9
```

```r
# Dimensions of transpose
dim(t(b))
```

```
## [1] 4 1
```

]

---

.pull-left[
`$$\begin{split}\mathbf{X} &amp;= \begin{bmatrix}
1 &amp; -2 &amp; 3 \\ 
4 &amp; -5 &amp; -6 \\ 
7 &amp; 8 &amp; 9 \\ 
0 &amp; 0 &amp; 10
\end{bmatrix}\\[3em]
\mathbf{X^{\prime}} &amp;= \begin{bmatrix}
1 &amp; 4 &amp; 7 &amp; 0 \\ -2 &amp; -5 &amp; 8 &amp; 0 \\ 3 &amp; -6 &amp; 9 &amp; 0 \end{bmatrix}\end{split}$$`
]

.pull-right[

```r
# Matrix transpose
t(X)
```

```
##      [,1] [,2] [,3] [,4]
## [1,]    1    4    7    0
## [2,]   -2   -5    8    0
## [3,]    3   -6    9   10
```

```r
# Dimensions of transpose
dim(t(X))
```

```
## [1] 3 4
```

]

---

# Your Turn

Find the transpose of `\(\mathbf{B}\)` and the dimensions of `\(\mathbf{B}^{\prime}\)`.

`$$\mathbf{B} = \begin{bmatrix}
-5 &amp; 1 &amp; 3 \\ 
2 &amp; 2 &amp; 6 \\ 
7 &amp; 3 &amp; -4
\end{bmatrix}$$`

Use R to verify.

--

.pull-left[

```r
# Transpose of B
t(B)
```

```
##      [,1] [,2] [,3]
## [1,]   -5    2    7
## [2,]    1    2    3
## [3,]    3    6   -4
```
]

.pull-right[

```r
# Dimensions
dim(t(B))
```

```
## [1] 3 3
```
]

---

# Adding/Subtracting Matrices

.pull-left[
Matrices that have the same dimensions can be added/subtracted.

`$$\underset{2\times 3}{\mathbf{D}} = \begin{bmatrix}
1 &amp; 2 &amp; 3 \\ 
4 &amp; 5 &amp; 6
\end{bmatrix}$$`

`$$\underset{2\times 3}{\mathbf{E}} = \begin{bmatrix}
-5 &amp; 1 &amp; 2 \\ 
3 &amp; 0 &amp; 4
\end{bmatrix}$$`

The resulting matrix has the same dimensions as the originals.
]

.pull-right[
We add/subtract elements in the same position.

`$$\begin{split}\mathbf{D}+\mathbf{E} &amp;= \begin{bmatrix}
1+-5 &amp; 2+1 &amp; 3+2 \\ 
4+3 &amp; 5+0 &amp; 6+4
\end{bmatrix} \\[1em]
&amp;= \begin{bmatrix}
-4 &amp; 3 &amp; 5 \\ 
7 &amp; 5 &amp; 10 \end{bmatrix}\end{split}$$`

`$$\begin{split}\mathbf{D}-\mathbf{E} &amp;= \begin{bmatrix}
1--5 &amp; 2-1 &amp; 3-2 \\ 
4-3 &amp; 5-0 &amp; 6-4
\end{bmatrix} \\[1em]
&amp;= \begin{bmatrix}
6 &amp; 1 &amp; 1 \\ 
1 &amp; 5 &amp; 2 \end{bmatrix}\end{split}$$`
]

---


.pull-left[

```r
# Input D
D = matrix(
  data = c(1, 2,  3,
           4, 5,  6),
  byrow = TRUE, 
  nrow = 2
  )

# Input E
E = matrix(
  data = c(-5, 1, 2,
            3, 0, 4),
  byrow = TRUE, 
  nrow = 2
  )
```
]

.pull-right[

```r
# Add matrices
D + E
```

```
##      [,1] [,2] [,3]
## [1,]   -4    3    5
## [2,]    7    5   10
```

```r
# Subtract matrices
D - E
```

```
##      [,1] [,2] [,3]
## [1,]    6    1    1
## [2,]    1    5    2
```
]


---

# Multiplication by a Scalar

.pull-left[
A scalar is a `\(1\times1\)` matrix (a number). A matrix and a scalar can be multiplied together by multiplying each element in the matrix by the scalar.

`$$\begin{split} 3 \times \mathbf{D} &amp;= 3\begin{bmatrix}
1 &amp; 2 &amp; 3 \\ 
4 &amp; 5 &amp; 6
\end{bmatrix}\\[1em]
&amp;= \begin{bmatrix}
3\times1 &amp; 3\times2 &amp; 3\times3 \\ 
3\times4 &amp; 3\times5 &amp; 3\times6
\end{bmatrix} \\[1em]
&amp;= \begin{bmatrix}
3 &amp; 6 &amp; 9 \\ 
12 &amp; 15 &amp; 18
\end{bmatrix}\end{split}$$`
]

.pull-right[

```r
# Multiplication by a scalar
3 * D
```

```
##      [,1] [,2] [,3]
## [1,]    3    6    9
## [2,]   12   15   18
```

]

---

# Diagonal Elements

.pull-left[
The `diag()` function will return the diagonal elements of a square matrix.

`$$\mathbf{B} = \begin{bmatrix}
-5 &amp; 1 &amp; 3 \\ 
2 &amp; 2 &amp; 6 \\ 
7 &amp; 3 &amp; -4
\end{bmatrix}$$`
]

.pull-right[

```r
diag(B)
```

```
## [1] -5  2 -4
```
]

---

# Your Turn

Find the diagonal for `\(\mathbf{B}^{\prime}\)` (the transpose of `\(\mathbf{B}\)`).

`$$\mathbf{B} = \begin{bmatrix}
-5 &amp; 1 &amp; 3 \\
2 &amp; 2 &amp; 6 \\
7 &amp; 3 &amp; -4
\end{bmatrix}$$`

Use R to verify.

--


```r
# Diagonal of B'
diag(t(B))
```

```
## [1] -5  2 -4
```

---

# Diagonal of Non-Square Matrices

.pull-left[
The `diag()` function also works on non-square matrices. However, it returns the elements on the diagonal starting with the element in the `\([1,1]\)` position.

`$$\mathbf{X} = \begin{bmatrix}
1 &amp; -2 &amp; 3 \\ 
4 &amp; -5 &amp; -6 \\ 
7 &amp; 8 &amp; 9 \\ 
0 &amp; 0 &amp; 10
\end{bmatrix}$$`
]

.pull-right[

```r
diag(X)
```

```
## [1]  1 -5  9
```
]

---

# Matrix Trace

.pull-left[
The trace of a matrix is the sum of its diagonal elements

`$$\mathbf{B} = \begin{bmatrix}
-5 &amp; 1 &amp; 3 \\ 
2 &amp; 2 &amp; 6 \\ 
7 &amp; 3 &amp; -4
\end{bmatrix}$$`
]

.pull-right[

```r
# Compute trace of B
sum(diag(B))
```

```
## [1] -7
```
]


You can also use the `tr()` function from the **psych** library to compute the trace.


```r
# Compute trace of B
psych::tr(B)
```

```
## [1] -7
```

---

# Your Turn

Find the trace for `\(\mathbf{B}^{\prime}\)` (the transpose of `\(\mathbf{B}\)`).

`$$\mathbf{B} = \begin{bmatrix}
-5 &amp; 1 &amp; 3 \\
2 &amp; 2 &amp; 6 \\
7 &amp; 3 &amp; -4
\end{bmatrix}$$`

Use R to verify.

--


```r
# Diagonal of B'
sum(diag(t(B)))
```

```
## [1] -7
```

---

# Identity Matrix

.pull-left[
The `diag()` function can also be used to create an *identity matrix*. The argument is the number of rows and columns.

`$$\underset{3\times 3}{\mathbf{I}} = \begin{bmatrix}
1 &amp; 0 &amp; 0 \\ 
0 &amp; 1 &amp; 0 \\ 
0 &amp; 0 &amp; 1
\end{bmatrix}$$`
]

.pull-right[

```r
# Create a 3x3 identity matrix
diag(3)
```

```
##      [,1] [,2] [,3]
## [1,]    1    0    0
## [2,]    0    1    0
## [3,]    0    0    1
```
]

---

# Determinant

.pull-left[
The `det()` function can be used to compute the *determinant* of a square matrix.

`$$\underset{2\times 2}{\mathbf{X}} = \begin{bmatrix}
-5 &amp; 1 \\ 
2 &amp; 2
\end{bmatrix}$$`
]

.pull-right[

```r
# Create X
X = matrix(
    data = c(-5, 1,
             2, 2),
    byrow = TRUE,
    nrow = 2
)

# Compute determinant
det(X)
```

```
## [1] -12
```
]

---

# Matrix Inverse

.pull-left[
The `solve()` function can be used to compute the *inverse* of a square matrix (if it exists).

`$$\underset{2\times 2}{\mathbf{X}}^{-1} = \begin{bmatrix}
-5 &amp; 1 \\ 
2 &amp; 2
\end{bmatrix}^{-1}$$`
]

.pull-right[

```r
# Compute inverse
solve(X)
```

```
##            [,1]       [,2]
## [1,] -0.1666667 0.08333333
## [2,]  0.1666667 0.41666667
```
]
    </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function() {
  var d = document, s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})();</script>

<script>
(function() {
  var i, text, code, codes = document.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
})();
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
